<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SamPack Online Order</title>
    <style>
        :root { --primary: #2c3e50; --accent: #27ae60; --bg: #f8f9fa; --text: #333; --card-bg: #fff; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); margin: 0; padding-bottom: 90px; color: var(--text); -webkit-font-smoothing: antialiased; }
        
        /* Header & Sticky Nav */
        .header { background: white; padding: 15px; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .top-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .logo { font-weight: 800; font-size: 1.3rem; color: var(--primary); letter-spacing: -0.5px; }
        .lang-switch button { padding: 4px 10px; border: 1px solid var(--primary); background: white; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.8rem; transition: all 0.2s; }
        .lang-switch button.active { background: var(--primary); color: white; }

        /* Search & Filter */
        .search-container { position: relative; margin-bottom: 10px; }
        .search-input { width: 100%; padding: 12px 15px; border: 1px solid #e1e4e8; border-radius: 10px; background: #f1f3f5; font-size: 1rem; outline: none; box-sizing: border-box; }
        .search-input:focus { background: white; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(44, 62, 80, 0.1); }
        
        .filter-scroll { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; -ms-overflow-style: none; }
        .filter-scroll::-webkit-scrollbar { display: none; }
        .filter-btn { white-space: nowrap; padding: 8px 16px; border: none; background: #e9ecef; border-radius: 20px; color: #495057; font-weight: 600; font-size: 0.9rem; cursor: pointer; transition: all 0.2s; }
        .filter-btn.active { background: var(--primary); color: white; box-shadow: 0 2px 5px rgba(44, 62, 80, 0.3); }

        /* Product List */
        .container { max-width: 800px; margin: 0 auto; padding: 15px; }
        
        .product-card { background: var(--card-bg); border-radius: 16px; padding: 15px; margin-bottom: 15px; display: flex; gap: 15px; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.04); transition: transform 0.2s; border: 1px solid transparent; }
        .product-card:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.08); }
        
        /* Image Handling */
        .prod-img { width: 70px; height: 70px; border-radius: 10px; object-fit: cover; background: #f8f9fa; display: none; } /* Hidden by default if no src */
        .prod-img.loaded { display: block; }

        .prod-info { flex: 1; min-width: 0; }
        .prod-name { font-weight: 700; font-size: 1rem; margin-bottom: 4px; line-height: 1.3; color: var(--primary); }
        .prod-detail { font-size: 0.85rem; color: #868e96; margin-bottom: 4px; }
        .prod-code { font-size: 0.75rem; color: #adb5bd; background: #f8f9fa; padding: 2px 6px; border-radius: 4px; display: inline-block; }
        .prod-price { color: var(--accent); font-weight: 800; font-size: 1.1rem; margin-top: 6px; }

        .controls { display: flex; flex-direction: column; align-items: center; gap: 5px; background: #f8f9fa; padding: 5px; border-radius: 12px; min-width: 40px; }
        .btn-qty { width: 32px; height: 32px; border: none; background: white; border-radius: 50%; font-size: 18px; color: var(--primary); cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); transition: background 0.1s; }
        .btn-qty:active { background: #e9ecef; }
        .qty-val { font-weight: 700; font-size: 1rem; min-height: 20px; display: flex; align-items: center; }
        .qty-val.hidden { visibility: hidden; }

        /* Cart Bar */
        .cart-bar { position: fixed; bottom: 0; left: 0; right: 0; background: white; border-top: 1px solid #edf2f7; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); z-index: 200; backdrop-filter: blur(10px); background: rgba(255,255,255,0.95); }
        .cart-info { display: flex; flex-direction: column; }
        .cart-total { font-weight: 800; font-size: 1.3rem; color: var(--primary); }
        .cart-count { font-size: 0.85rem; color: #868e96; font-weight: 600; }
        .btn-checkout { background: var(--accent); color: white; border: none; padding: 14px 30px; border-radius: 30px; font-weight: 700; font-size: 1rem; cursor: pointer; box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3); transition: transform 0.1s; }
        .btn-checkout:active { transform: scale(0.96); }

        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; align-items: center; justify-content: center; backdrop-filter: blur(3px); }
        .modal-content { background: white; width: 90%; max-width: 500px; padding: 30px; border-radius: 20px; max-height: 85vh; overflow-y: auto; position: relative; box-shadow: 0 10px 40px rgba(0,0,0,0.2); animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .close-btn { position: absolute; right: 25px; top: 20px; font-size: 28px; cursor: pointer; color: #adb5bd; }
        
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 700; font-size: 0.9rem; color: var(--primary); }
        .form-group input { width: 100%; padding: 14px; border: 2px solid #f1f3f5; border-radius: 12px; box-sizing: border-box; font-size: 1rem; transition: border 0.2s; }
        .form-group input:focus { border-color: var(--primary); outline: none; }
        
        .order-summary { background: #f8f9fa; padding: 15px; border-radius: 12px; margin-bottom: 25px; font-size: 0.9rem; border: 1px solid #e9ecef; }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px dashed #dee2e6; }
        .summary-row:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }

        .btn-action { width: 100%; padding: 16px; border: none; border-radius: 14px; font-weight: 700; font-size: 1rem; cursor: pointer; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 10px; transition: transform 0.1s; }
        .btn-whatsapp { background: #25D366; color: white; box-shadow: 0 4px 15px rgba(37, 211, 102, 0.2); }
        .btn-email { background: var(--primary); color: white; box-shadow: 0 4px 15px rgba(44, 62, 80, 0.2); }
        .btn-action:active { transform: scale(0.98); }

        .highlight-match { background-color: #fff3cd; }
    </style>
</head>
<body>

<div class="header">
    <div class="top-row">
        <div class="logo">üì¶ SamPack</div>
        <div class="lang-switch">
            <button id="btn-de" class="active" onclick="setLang('de')">DE</button>
            <button id="btn-fr" onclick="setLang('fr')">FR</button>
        </div>
    </div>
    
    <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="üîç Suchen / Search..." oninput="filterProducts()">
    </div>

    <div class="filter-scroll" id="filter-buttons">
        <button class="filter-btn active" onclick="setCategory('all')">Alle</button>
        <button class="filter-btn" onclick="setCategory('packaging')">Verpackung</button>
        <button class="filter-btn" onclick="setCategory('food')">Lebensmittel</button>
        <button class="filter-btn" onclick="setCategory('sauce')">Saucen</button>
        <button class="filter-btn" onclick="setCategory('hygiene')">Hygiene</button>
    </div>
</div>

<div class="container" id="product-list">
    </div>

<div class="cart-bar">
    <div class="cart-info">
        <span class="cart-total" id="total-price">0.00 CHF</span>
        <span class="cart-count" id="item-count">0 Artikel</span>
    </div>
    <button class="btn-checkout" onclick="openCheckout()" id="lbl-view-cart">Warenkorb ></button>
</div>

<div class="modal" id="checkoutModal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeCheckout()">&times;</span>
        <h2 id="lbl-checkout-title" style="margin-top:0; color:var(--primary);">Bestellung pr√ºfen</h2>
        
        <div class="order-summary" id="order-summary"></div>

        <div class="form-group">
            <label id="lbl-name">Firmenname / Kontakt</label>
            <input type="text" id="customerName" placeholder="Name...">
        </div>
        <div class="form-group">
            <label id="lbl-address">Adresse</label>
            <input type="text" id="customerAddress" placeholder="Strasse, Ort...">
        </div>
        <div class="form-group">
            <label id="lbl-date">Lieferdatum</label>
            <input type="date" id="deliveryDate">
        </div>

        <button class="btn-action btn-whatsapp" onclick="sendWhatsapp()">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592z"/></svg>
            WhatsApp
        </button>
        <button class="btn-action btn-email" onclick="sendEmail()">
            üìß Email Senden
        </button>
    </div>
</div>

<script>
    // --- DATABASE ---
    // ŸÑ€åÿ≥ÿ™ ⁄©ÿßŸÖŸÑ ŸÖÿ≠ÿµŸàŸÑÿßÿ™ ÿßÿ≥ÿ™ÿÆÿ±ÿßÿ¨ ÿ¥ÿØŸá ÿßÿ≤ ŸÅÿß€åŸÑ ÿ¥ŸÖÿß
    const products = [
        { id: "14", cat: "food", code: "001", name: "Pommes, Fine Quality-10 M", price: 3.60, unit: "kg" },
        { id: "19", cat: "food", code: "0010", name: "Chicken Nugget 10 KG", price: 89.00, unit: "Packung" },
        { id: "117", cat: "food", code: "0010", name: "Pommes frites -6.6 mm", price: 30.00, unit: "Packung" },
        { id: "17", cat: "food", code: "0011", name: "Cordon Bleu", price: 75.00, unit: "Packung" },
        { id: "16", cat: "food", code: "0012", name: "Thunfisch", price: 25.00, unit: "Packung" },
        { id: "20", cat: "food", code: "0012", name: "Schnitzel 5 Kg", price: 90.00, unit: "Packung" },
        { id: "36", cat: "food", code: "0013", name: "Frittes √ñL, 10 liter", price: 38.00, unit: "Stk" },
        { id: "132", cat: "packaging", code: "0015", name: "Plastiksack t√ºte ,klein", price: 18.00, unit: "Packung" },
        { id: "122", cat: "food", code: "002", name: "Pommes,Fine Quality-7mm", price: 3.50, unit: "kg" },
        { id: "60", cat: "packaging", code: "0020", name: "Plastiksack t√ºte, Mittlere", price: 18.00, unit: "Packung" },
        { id: "30", cat: "sauce", code: "0026", name: "Nawahl`s , Andalouse 12x950ml", price: 55.00, unit: "Packung" },
        { id: "15", cat: "food", code: "003", name: "Pommes, Fine Quality-10 M", price: 35.00, unit: "kg" },
        { id: "12", cat: "food", code: "004", name: "Pommes, Fine Quality-10 M", price: 3.20, unit: "kg" },
        { id: "123", cat: "food", code: "005", name: "Pommes Frits, Normal ,9.9 mm", price: 35.00, unit: "kg" },
        { id: "133", cat: "packaging", code: "0050", name: "Plastiksack t√ºte ,gross", price: 18.00, unit: "Packung" },
        { id: "124", cat: "food", code: "006", name: "Pommes, Fine Quality-10 M", price: 3.50, unit: "kg" },
        { id: "1", cat: "food", code: "007", name: "Mozzarella, 45 % Fett-12 Kg", price: 72.00, unit: "Packung" },
        { id: "143", cat: "food", code: "007S", name: "Mozzarella, 100 % Fett, 12 Kg", price: 78.00, unit: "Packung" },
        { id: "10", cat: "food", code: "008", name: "Mozzarella, Zucker, 45 % Fett-10 Kg", price: 75.00, unit: "Packung" },
        { id: "131", cat: "packaging", code: "0083", name: "Pizza Box Italy 32x32x43cm", price: 23.00, unit: "Packung" },
        { id: "18", cat: "food", code: "009", name: "H√§nchen Brust-12 kg", price: 90.00, unit: "Packung" },
        { id: "56", cat: "hygiene", code: "0981", name: "Bulky Servietten , Rot 40x40", price: 50.00, unit: "Packung" },
        { id: "67", cat: "hygiene", code: "0990", name: "Serviette, 5000 St√ºck", price: 29.00, unit: "Packung" },
        { id: "120", cat: "hygiene", code: "0998", name: "Serviette 1/8 Take Away", price: 25.00, unit: "Packung" },
        { id: "58", cat: "hygiene", code: "1002", name: "Papierhandtuch", price: 30.00, unit: "Packung" },
        { id: "63", cat: "hygiene", code: "1003", name: "Rollenpapier - 6 Rollen", price: 19.00, unit: "Packung" },
        { id: "121", cat: "hygiene", code: "1004", name: "Rollenpapier - 12 Rollen", price: 20.00, unit: "Packung" },
        { id: "115", cat: "hygiene", code: "1005", name: "Toilette Papier", price: 20.00, unit: "Packung" },
        { id: "125", cat: "hygiene", code: "1006", name: "K√ºchen Rollen, 32 St", price: 33.00, unit: "Packung" },
        { id: "74", cat: "packaging", code: "1050", name: "Donner Box, 16oz, klein", price: 45.00, unit: "Packung" },
        { id: "75", cat: "packaging", code: "1060", name: "Donner Box, 26oz, mittlere", price: 45.00, unit: "Packung" },
        { id: "76", cat: "packaging", code: "1070", name: "Donner box, 32oz, Gross", price: 45.00, unit: "Packung" },
        { id: "65", cat: "hygiene", code: "1541", name: "Gabel (Forks)", price: 30.00, unit: "Packung" },
        { id: "114", cat: "packaging", code: "1676", name: "Lunch-Box-IP 10 Wei√ü", price: 53.48, unit: "Packung" },
        { id: "134", cat: "packaging", code: "1681", name: "Menu Box, IP 4", price: 33.00, unit: "Packung" },
        { id: "111", cat: "packaging", code: "1681", name: "Men√º-Box-3geteilt-weiss", price: 30.00, unit: "Packung" },
        { id: "43", cat: "sauce", code: "2023", name: "Remia Cocktail Sauce, 10 Kg", price: 29.00, unit: "Stk" },
        { id: "32", cat: "sauce", code: "2025", name: "Nawahl`s Algerien 12x950ml", price: 55.00, unit: "Packung" },
        { id: "26", cat: "sauce", code: "2026", name: "Nawals Samurai 12x950ml", price: 55.00, unit: "Packung" },
        { id: "28", cat: "sauce", code: "2029", name: "Nawahl`s Tartar 12x950ml", price: 55.00, unit: "Packung" },
        { id: "27", cat: "sauce", code: "2030", name: "Nawals Barbecue 12x950ml", price: 55.00, unit: "Packung" },
        { id: "107", cat: "packaging", code: "2032A", name: "Frischhaltefolie 45 cm", price: 40.00, unit: "Stk" },
        { id: "59", cat: "packaging", code: "2045", name: "Donner t√ºten", price: 17.00, unit: "Packung" },
        { id: "126", cat: "packaging", code: "2046", name: "D√ºr√ºm T√ºte", price: 20.00, unit: "Packung" },
        { id: "57", cat: "packaging", code: "2070", name: "Aluminium Folie 14mm (4 Stk)", price: 25.00, unit: "Packung" },
        { id: "83", cat: "packaging", code: "2530", name: "Aluminium schale 100 st√ºck", price: 37.00, unit: "Packung" },
        { id: "127", cat: "packaging", code: "511", name: "Salat Schale - 375 ml", price: 55.00, unit: "Packung" },
        { id: "146", cat: "hygiene", code: "Air", name: "Airlaid Servietten Rot", price: 130.00, unit: "Packung" },
        { id: "82", cat: "packaging", code: "Alu", name: "Aluminium box 2000 cc", price: 75.00, unit: "Packung" },
        { id: "81", cat: "packaging", code: "Alu", name: "Aluminium Box 2380 cc", price: 80.00, unit: "Packung" },
        { id: "22", cat: "food", code: "Ant", name: "Antalya Brot-9,7 Kg", price: 27.00, unit: "Packung" },
        { id: "51", cat: "food", code: "Bas", name: "Basilikum", price: 20.00, unit: "Packung" },
        { id: "69", cat: "hygiene", code: "Bes", name: "Besteck Taschen", price: 50.00, unit: "Packung" },
        { id: "62", cat: "hygiene", code: "Bes", name: "Besteck-Set", price: 24.00, unit: "Packung" },
        { id: "72", cat: "packaging", code: "Bio", name: "Bio-Salatschalen 1000 ml", price: 80.00, unit: "Packung" },
        { id: "73", cat: "packaging", code: "Bio", name: "Bio-Salatschalen 1300 ml", price: 90.00, unit: "Packung" },
        { id: "109", cat: "packaging", code: "Bio", name: "Bio-Salatschalen 375 ml", price: 65.00, unit: "Packung" },
        { id: "70", cat: "packaging", code: "Bio", name: "Bio-Salatschalen 500 ml", price: 50.00, unit: "Packung" },
        { id: "71", cat: "packaging", code: "Bio", name: "Bio-Salatschalen 750 ml", price: 65.00, unit: "Packung" },
        { id: "55", cat: "hygiene", code: "Bulk", name: "Bulky Servietten 40x40", price: 50.00, unit: "Packung" },
        { id: "48", cat: "food", code: "Chi", name: "Chili Feuer - mix 50", price: 20.00, unit: "Packung" },
        { id: "137", cat: "sauce", code: "Chi", name: "Chili-Cheese Sauce", price: 45.00, unit: "Packung" },
        { id: "119", cat: "food", code: "Dil", name: "Dill", price: 17.00, unit: "Packung" },
        { id: "110", cat: "packaging", code: "Dur", name: "D√ºrum T√ºte", price: 25.00, unit: "Packung" },
        { id: "21", cat: "food", code: "Fal", name: "Falafel", price: 45.00, unit: "Packung" },
        { id: "94", cat: "packaging", code: "Food", name: "Food Container box", price: 200.00, unit: "Packung" },
        { id: "93", cat: "packaging", code: "Food", name: "Food Container box 190x60", price: 200.00, unit: "Packung" },
        { id: "104", cat: "packaging", code: "Fri", name: "Frischpack zuschnitte", price: 45.00, unit: "Packung" },
        { id: "118", cat: "packaging", code: "Fri", name: "Frishhaltfolie , normal", price: 20.00, unit: "Packung" },
        { id: "38", cat: "food", code: "Oil", name: "Frittes √ñL, 20 Liter", price: 80.00, unit: "Stk" },
        { id: "23", cat: "food", code: "Oli", name: "Geschnittene Oliven", price: 39.00, unit: "Packung" },
        { id: "106", cat: "packaging", code: "Ham", name: "Hamburger Box- papstar", price: 37.70, unit: "Packung" },
        { id: "144", cat: "hygiene", code: "Glo", name: "Handschuhe-L", price: 35.00, unit: "Packung" },
        { id: "145", cat: "hygiene", code: "Glo", name: "Handschuhe-M", price: 35.00, unit: "Packung" },
        { id: "98", cat: "packaging", code: "Kaf", name: "Kaffebecher", price: 30.00, unit: "Stk" },
        { id: "130", cat: "sauce", code: "Ket", name: "Ketchup Rozan 10 Kg", price: 18.00, unit: "Stk" },
        { id: "139", cat: "food", code: "Kim", name: "Kimyon-Kreuzk√ºmmel", price: 11.90, unit: "Packung" },
        { id: "53", cat: "food", code: "Kno", name: "Knobloch Pulver", price: 20.00, unit: "Packung" },
        { id: "66", cat: "hygiene", code: "Lof", name: "L√∂ffel (Spoons)", price: 30.00, unit: "Packung" },
        { id: "95", cat: "packaging", code: "Lun", name: "lunch menu box 375 ml", price: 60.00, unit: "Packung" },
        { id: "96", cat: "packaging", code: "Lun", name: "Lunch menu box 500 ml", price: 60.00, unit: "Packung" },
        { id: "97", cat: "packaging", code: "Lun", name: "Lunch menu box 750 ml", price: 60.00, unit: "Packung" },
        { id: "129", cat: "sauce", code: "May", name: "Mayonnaise Rozan 10 Kg", price: 23.00, unit: "Stk" },
        { id: "140", cat: "sauce", code: "May", name: "Mayonnaise Tanri√∂ver 10 L", price: 23.00, unit: "Stk" },
        { id: "108", cat: "packaging", code: "Men", name: "Men√º-Box 2geteilt weiss", price: 37.00, unit: "Packung" },
        { id: "68", cat: "hygiene", code: "Mes", name: "Messer (Knives)", price: 29.00, unit: "Packung" },
        { id: "29", cat: "sauce", code: "Naw", name: "Nawahl`s Biggy Burger", price: 55.00, unit: "Packung" },
        { id: "31", cat: "sauce", code: "Naw", name: "Nawahl`s Curry 12er", price: 55.00, unit: "Packung" },
        { id: "25", cat: "sauce", code: "Naw", name: "Nawahl`s Marocain", price: 55.00, unit: "Packung" },
        { id: "138", cat: "food", code: "Oli", name: "Oliven √ñl", price: 28.90, unit: "Stk" },
        { id: "50", cat: "food", code: "Ore", name: "Oregano", price: 20.00, unit: "Packung" },
        { id: "113", cat: "packaging", code: "Pap", name: "Papier √† pizza", price: 40.00, unit: "Packung" },
        { id: "101", cat: "packaging", code: "Bag", name: "Papiertasche Mittel", price: 35.00, unit: "Packung" },
        { id: "100", cat: "packaging", code: "Bag", name: "Papiertasche Klein", price: 35.00, unit: "Packung" },
        { id: "102", cat: "packaging", code: "Bag", name: "Papiertasche Gross", price: 35.00, unit: "Packung" },
        { id: "42", cat: "food", code: "Pet", name: "Petersille", price: 20.00, unit: "Packung" },
        { id: "41", cat: "food", code: "Pfe", name: "Pfeffer schwarz", price: 20.00, unit: "Packung" },
        { id: "40", cat: "food", code: "Pfe", name: "Pfefferminz", price: 20.00, unit: "Packung" },
        { id: "88", cat: "packaging", code: "Piz", name: "Pizza Box 32x32x4 cm", price: 23.00, unit: "Packung" },
        { id: "89", cat: "packaging", code: "Piz", name: "Pizza Box 36x36x4 cm", price: 24.00, unit: "Packung" },
        { id: "91", cat: "packaging", code: "Piz", name: "Pizza Box 40x40x4 cm", price: 45.00, unit: "Packung" },
        { id: "90", cat: "packaging", code: "Piz", name: "Pizza Box 45x45x4.5 cm", price: 45.00, unit: "Packung" },
        { id: "85", cat: "packaging", code: "Piz", name: "Pizza Box 24x24x4 cm", price: 20.00, unit: "Packung" },
        { id: "84", cat: "packaging", code: "Piz", name: "Pizza Box 28x28x4 cm", price: 20.00, unit: "Packung" },
        { id: "87", cat: "packaging", code: "Piz", name: "Pizza Box 30x30x4 cm", price: 24.00, unit: "Packung" },
        { id: "86", cat: "packaging", code: "Piz", name: "Pizza Box 33x33x4 cm", price: 24.00, unit: "Packung" },
        { id: "92", cat: "packaging", code: "Piz", name: "Pizza Box 50x50x4.5 cm", price: 48.00, unit: "Packung" },
        { id: "103", cat: "packaging", code: "Piz", name: "Pizza Calzone box", price: 25.00, unit: "Packung" },
        { id: "142", cat: "sauce", code: "Tom", name: "Pizza Tomatensauce", price: 30.00, unit: "Stk" },
        { id: "61", cat: "packaging", code: "Pla", name: "Plastikt√ºtenrollen 24 st√ºck", price: 45.00, unit: "Packung" },
        { id: "52", cat: "food", code: "Pul", name: "Pul Bieber", price: 20.00, unit: "Packung" },
        { id: "44", cat: "sauce", code: "Rem", name: "Remia Mayonnaise 10 Kg", price: 27.00, unit: "Stk" },
        { id: "78", cat: "packaging", code: "Sau", name: "Sauceenschale 50 ml", price: 49.50, unit: "Packung" },
        { id: "80", cat: "packaging", code: "Sau", name: "Sauceenschalen 120 ml", price: 49.50, unit: "Packung" },
        { id: "77", cat: "packaging", code: "Sau", name: "Sauceenschalen 30 ml", price: 49.00, unit: "Packung" },
        { id: "79", cat: "packaging", code: "Sau", name: "Sauceenschalen 80 ml", price: 40.00, unit: "Packung" },
        { id: "47", cat: "sauce", code: "Sch", name: "Scharf Sauce burcu 10Kg", price: 28.00, unit: "Stk" },
        { id: "24", cat: "sauce", code: "Sch", name: "Scharf Sauce 12er", price: 49.00, unit: "Packung" },
        { id: "54", cat: "food", code: "Sch", name: "schwarzk√ºmmel", price: 20.00, unit: "Packung" },
        { id: "39", cat: "food", code: "Son", name: "Sonnenblumen √ñl, 1 Liter", price: 33.00, unit: "Packung" },
        { id: "35", cat: "food", code: "Son", name: "Sonnenblumen √ñl, 10 Liter", price: 35.00, unit: "Stk" },
        { id: "49", cat: "food", code: "Sum", name: "Sumachpulver", price: 20.00, unit: "Packung" },
        { id: "64", cat: "hygiene", code: "Toi", name: "Toilettenpapier Rolle", price: 26.00, unit: "Packung" },
        { id: "128", cat: "packaging", code: "Wac", name: "Wach papier", price: 45.00, unit: "Packung" }
    ];

    const translations = {
        de: { view_cart: "Warenkorb >", checkout_title: "Bestellung pr√ºfen", name: "Firmenname / Kontakt", address: "Lieferadresse", date: "Lieferdatum", items: "Artikel", whatsapp_msg: "Hallo, neue Bestellung:", email_sent: "Bestellung gesendet! ‚úÖ", fill_all: "Bitte Name eingeben!", search_ph: "üîç Suchen...", all: "Alle", packaging: "Verpackung", food: "Lebensmittel", sauce: "Saucen", hygiene: "Hygiene" },
        fr: { view_cart: "Panier >", checkout_title: "V√©rifier commande", name: "Nom / Contact", address: "Adresse livraison", date: "Date livraison", items: "Articles", whatsapp_msg: "Bonjour, nouvelle commande:", email_sent: "Commande envoy√©e! ‚úÖ", fill_all: "Entrez votre nom SVP!", search_ph: "üîç Rechercher...", all: "Tous", packaging: "Emballage", food: "Alimentation", sauce: "Sauces", hygiene: "Hygi√®ne" }
    };

    let cart = {};
    let currentLang = 'de';
    let currentCategory = 'all';

    function init() { 
        filterProducts(); 
        document.getElementById('deliveryDate').valueAsDate = new Date(); 
    }

    function setLang(lang) {
        currentLang = lang;
        document.getElementById('btn-de').className = lang === 'de' ? 'active' : '';
        document.getElementById('btn-fr').className = lang === 'fr' ? 'active' : '';
        
        const t = translations[lang];
        document.getElementById('lbl-view-cart').innerText = t.view_cart;
        document.getElementById('lbl-checkout-title').innerText = t.checkout_title;
        document.getElementById('lbl-name').innerText = t.name;
        document.getElementById('lbl-address').innerText = t.address;
        document.getElementById('lbl-date').innerText = t.date;
        document.getElementById('searchInput').placeholder = t.search_ph;

        // Update Filter Button Text
        const btns = document.getElementById('filter-buttons').children;
        btns[0].innerText = t.all;
        btns[1].innerText = t.packaging;
        btns[2].innerText = t.food;
        btns[3].innerText = t.sauce;
        btns[4].innerText = t.hygiene;

        if(document.getElementById('checkoutModal').style.display === 'flex') renderCartSummary();
    }

    function setCategory(cat) {
        currentCategory = cat;
        // Update styling
        const btns = document.querySelectorAll('.filter-btn');
        btns.forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        
        filterProducts();
    }

    function filterProducts() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const container = document.getElementById('product-list');
        container.innerHTML = "";

        products.forEach(p => {
            // Check Category
            if (currentCategory !== 'all' && p.cat !== currentCategory) return;
            // Check Search
            if (searchTerm && !p.name.toLowerCase().includes(searchTerm) && !p.code.toLowerCase().includes(searchTerm)) return;

            const qty = cart[p.id] || 0;
            // Image Logic: tries to load images/ID.jpg
            const imgPath = `images/${p.code}.jpg`; 
            
            container.innerHTML += `
            <div class="product-card">
                <img src="${imgPath}" class="prod-img" onload="this.classList.add('loaded')" onerror="this.style.display='none'">
                <div class="prod-info">
                    <div class="prod-name">${p.name}</div>
                    <div class="prod-detail">${p.unit} <span class="prod-code">#${p.code}</span></div>
                    <div class="prod-price">${p.price.toFixed(2)} CHF</div>
                </div>
                <div class="controls">
                    <button class="btn-qty" onclick="updateCart('${p.id}', 1)">+</button>
                    <div class="qty-val ${qty===0?'hidden':''}">${qty}</div>
                    <button class="btn-qty" onclick="updateCart('${p.id}', -1)" style="${qty===0?'visibility:hidden':''}">-</button>
                </div>
            </div>`;
        });
    }

    function updateCart(id, change) {
        if (!cart[id]) cart[id] = 0;
        cart[id] += change;
        if (cart[id] <= 0) delete cart[id];
        
        filterProducts(); // Re-render to show qty updates
        updateCartBar();
    }

    function updateCartBar() {
        let total = 0; let count = 0;
        for (const [id, qty] of Object.entries(cart)) {
            const p = products.find(x => x.id === id);
            if(p) { total += p.price * qty; count += qty; }
        }
        document.getElementById('total-price').innerText = total.toFixed(2) + " CHF";
        document.getElementById('item-count').innerText = `${count} ${translations[currentLang].items}`;
    }

    function openCheckout() {
        if (Object.keys(cart).length === 0) return;
        renderCartSummary();
        document.getElementById('checkoutModal').style.display = 'flex';
    }
    function closeCheckout() { document.getElementById('checkoutModal').style.display = 'none'; }

    function renderCartSummary() {
        const div = document.getElementById('order-summary');
        div.innerHTML = "";
        let total = 0;
        for (const [id, qty] of Object.entries(cart)) {
            const p = products.find(x => x.id === id);
            const lineTotal = p.price * qty;
            total += lineTotal;
            div.innerHTML += `<div class="summary-row">
                <span>${qty}x ${p.name}</span>
                <span>${lineTotal.toFixed(2)}</span>
            </div>`;
        }
        div.innerHTML += `<div style="text-align:right; font-weight:800; margin-top:10px; border-top:2px solid #eee; padding-top:10px; font-size:1.1rem;">Total: ${total.toFixed(2)} CHF</div>`;
    }

    function getOrderText() {
        const name = document.getElementById('customerName').value;
        const address = document.getElementById('customerAddress').value;
        const date = document.getElementById('deliveryDate').value;
        const t = translations[currentLang];
        
        let text = `*${t.whatsapp_msg}*\n`;
        text += `üë§ ${name}\nüìç ${address}\nüìÖ ${date}\n\n`;
        let total = 0;
        for (const [id, qty] of Object.entries(cart)) {
            const p = products.find(x => x.id === id);
            text += `‚ñ™Ô∏è ${qty}x ${p.name}\n`;
            total += p.price * qty;
        }
        text += `\n*Total: ${total.toFixed(2)} CHF*`;
        return text;
    }

    function sendWhatsapp() {
        const name = document.getElementById('customerName').value;
        if (!name) return alert(translations[currentLang].fill_all);
        
        // *** ÿ¥ŸÖÿßÿ±Ÿá Ÿàÿßÿ™ÿ≥‚ÄåÿßŸæ ÿ¥ŸÖÿß ***
        const myNumber = "41783249525"; 
        
        const text = encodeURIComponent(getOrderText());
        window.open(`https://wa.me/${myNumber}?text=${text}`, '_blank');
    }

    async function sendEmail() {
        const name = document.getElementById('customerName').value;
        if (!name) return alert(translations[currentLang].fill_all);
        const btn = document.querySelector('.btn-email');
        const oldText = btn.innerText;
        btn.disabled = true; btn.innerText = "...";

        try {
            const formData = new FormData();
            
            // *** ⁄©ŸÑ€åÿØ WEB3FORMS ÿÆŸàÿØ ÿ±ÿß ÿß€åŸÜÿ¨ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ ***
            formData.append("access_key", "01c92836-701d-4faf-91b9-3836ee825485"); 

            formData.append("subject", `New Order: ${name}`);
            formData.append("message", getOrderText());
            const res = await fetch("https://api.web3forms.com/submit", { method: "POST", body: formData });
            if (res.ok) {
                alert(translations[currentLang].email_sent);
                closeCheckout();
                cart = {};
                filterProducts();
                updateCartBar();
            } else { alert("Error sending email."); }
        } catch (e) { alert("Connection error."); }
        btn.disabled = false; btn.innerText = oldText;
    }

    init();
</script>
</body>
</html>
